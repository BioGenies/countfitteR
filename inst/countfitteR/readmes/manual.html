<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>manual.utf8</title>

<script src="manual_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="manual_files/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="manual_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="manual_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="manual_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="manual_files/navigation-1.1/tabsets.js"></script>
<link href="manual_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="manual_files/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="fluid-row" id="header">




</div>

<div id="TOC">
<ul>
<li><a href="#countfitter"><strong>countfitteR</strong></a><ul>
<li><a href="#general-tips">General tips</a><ul>
<li><a href="#charts">Charts</a></li>
<li><a href="#tables">Tables</a></li>
</ul></li>
<li><a href="#data-upload">Data upload</a></li>
<li><a href="#count-data">Count data</a></li>
<li><a href="#fitted-models">Fitted models</a></li>
<li><a href="#compare-distributions">Compare distributions</a></li>
<li><a href="#settings">Settings</a></li>
</ul></li>
<li><a href="#overdispersion">Overdispersion</a><ul>
<li><a href="#overdispersed-count-data-distributions">Overdispersed count data distributions</a></li>
</ul></li>
</ul>
</div>

<div id="countfitter" class="section level1">
<h1><strong>countfitteR</strong></h1>
<div id="general-tips" class="section level2">
<h2>General tips</h2>
<div id="charts" class="section level3">
<h3>Charts</h3>
<p>Each chart may be saved in the <code>.svg</code> format. A download button is always located at the top of a chart.</p>
</div>
<div id="tables" class="section level3">
<h3>Tables</h3>
<p>Tables may be downloaded in a specified format or printed using the buttons at the top of the table.</p>
</div>
</div>
<div id="data-upload" class="section level2">
<h2>Data upload</h2>
<p>The data format suitable for upload is the .csv document, where a single column corresponds to a single count. Use raw counts instead a pivot table. If your document does not have headers, specify it using the “Header” checkbox. In this case, <strong>countfitter</strong> will automatically name your counts with the index number of a count prefixed by ‘C’.</p>
</div>
<div id="count-data" class="section level2">
<h2>Count data</h2>
<p>This panel contains descriptive statistics and summaries of the input data. It consists of three subpanels:<br />
1. <em>Count table</em>: the input dataset in the tabular format allowing sanity checks and manual modification. 2. <em>Summary</em>: summary statistics of the input data (respectively mean, standard deviation, median, median absolute deviate, minimum, maximum, number of elements).<br />
3. <em>Distribution</em>: a bar chart of the counts distribution followed by a pivot table.</p>
</div>
<div id="fitted-models" class="section level2">
<h2>Fitted models</h2>
<ol style="list-style-type: decimal">
<li><em>Mean value estimates</em>: the estimated value of mean (<span class="math inline">\(\lambda\)</span>) and its confidence intervals. The BIC indicates the most appropriate distribution.<br />
</li>
<li><em>Coefficients</em>: coefficients of fitted models.</li>
<li><em>Decision</em>: the most appropriate model and the strength of the evidence (Kass and Raftery, 1995).</li>
</ol>
</div>
<div id="compare-distributions" class="section level2">
<h2>Compare distributions</h2>
<p>The bar charts represent theoretical counts depending on the chosen distribution. Red dots describe the real number of counts. The visualized data is also available in the tabular format.</p>
</div>
<div id="settings" class="section level2">
<h2>Settings</h2>
<p><strong>Separate experiments</strong>: if this checkbox is marked, the <strong>countfitter</strong> assumes that experiments are separate and fits the distribution to each individually and independently. Otherwise, all counts are simultaneously fitted to a single model. It is more appropriate for situations, where there is assumption that all samples may be describe by the same distribution, for example in case of technical replicates.</p>
<p><strong>Confidence level</strong>: the confidence level of confidence intervals.</p>
<p><strong>Count distributions</strong>: count distributions fitted to data: Poisson, Negative Binomial, Zero-Inflated Poisson, Zero-Inflated Negative Binomial. Possible distributions are described further in the manual.</p>
</div>
</div>
<div id="overdispersion" class="section level1">
<h1>Overdispersion</h1>
<p>One of the important features of the Poisson distribution is the equality of variance and expected value. Although count data is commonly assumed to be Poisson-distributed, we often encounter overdispersed datasets, when the variance is bigger than the mean. Three distributions included in <strong>countfitter</strong>: Zero-Inflated Poisson (ZIP), Negative Binomial (NB) and Zero-negative Binomial (ZINB) model overdispersed counts.</p>
<p>Overdispersion may be caused by the increased variability of counts, for example when a counting algorithm under- and overcounts. In such situation the data might have the NB distribution. The other cause of overdispersion is called zero-inflation and occurs in datasets, where some factor introduced faulty zeros. That means that some counts, regardless of their real state, are treated as zeros. In this case, data has the ZIP distribution. If both faulty zeros and increased variance affect the data, the ZINB distribution is the most appropriate.</p>
<div id="overdispersed-count-data-distributions" class="section level2">
<h2>Overdispersed count data distributions</h2>
<p>Parameters:</p>
<ul>
<li><span class="math inline">\(\lambda\)</span> - Poisson parameter (average number of foci per cell).<br />
</li>
<li><span class="math inline">\(r\)</span> - zero inflation (fraction of cells treated by system as having no foci regardless of their real state).<br />
</li>
<li><span class="math inline">\(\theta\)</span> - dispersion parameter.</li>
</ul>
<p>Usually the NB distribution is parameterized using <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\theta\)</span>, but to make comparison clearer, we use <span class="math inline">\(\lambda\)</span> instead of <span class="math inline">\(\mu\)</span>. In this parameterization, NB and ZINB are treated as the mixture of Poisson and Gamma (<span class="math inline">\(\Gamma\)</span>) distributions.</p>
<table>
<colgroup>
<col width="59%" />
<col width="40%" />
</colgroup>
<thead>
<tr class="header">
<th>Distribution <br> name</th>
<th>pmf</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Poisson</td>
<td><span class="math display">\[P\{X = k\} = \frac{\lambda^k \exp^{-\lambda}}{k!} \]</span></td>
</tr>
<tr class="even">
<td>Zero-inflated Poisson</td>
<td><span class="math display">\[P\{X = k\} = \begin{cases} r + ( 1- r) \exp^{-\lambda},\text{if } k = 0\\ r \frac{\lambda^k \exp^{-\lambda}}{k!},\text{if } k = 1, 2, \ldots \end{cases} \]</span></td>
</tr>
<tr class="odd">
<td>Negative Binomial</td>
<td><span class="math display">\[P\{X = k\} = \frac{\Gamma (\theta + k)}{\Gamma(\theta) k!}  \left(\left( \frac{\theta}{\theta + \lambda} \right)^\theta \left( \frac{\lambda}{\theta + \lambda} \right) \right)^k\]</span></td>
</tr>
<tr class="even">
<td>Zero-inflated Negative Binomial</td>
<td><span class="math display">\[P\{X = k\} = \begin{cases}r + (1 - r) \left( \frac{\theta}{\theta + \lambda} \right)^\theta,\text{if } k = 0\\(1 - r) \frac{\Gamma (\theta + k)}{\Gamma(\theta) k!}  \left(\left( \frac{\theta}{\theta + \lambda} \right)^\theta \left( \frac{\lambda}{\theta + \lambda} \right) \right)^k,\text{if } k = 1, 2, \ldots\end{cases}\]</span></td>
</tr>
</tbody>
</table>
<p>Poisson and Negative Binomial distributions have the same expected value. In case of ZIP and ZINB, the expected value is smaller than the real average number of foci per cell.</p>
<table>
<thead>
<tr class="header">
<th>Distribution <br> name</th>
<th>Expected value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Poisson</td>
<td><span class="math display">\[E(X) = \lambda \]</span></td>
</tr>
<tr class="even">
<td>ZIP</td>
<td><span class="math display">\[E(X) = (1 - r) \lambda \]</span></td>
</tr>
<tr class="odd">
<td>NB</td>
<td><span class="math display">\[E(X) = \lambda \]</span></td>
</tr>
<tr class="even">
<td>ZINB</td>
<td><span class="math display">\[E(X) = (1 - r)  \lambda \]</span> <!-- keep it here, because otherwise table parse oddly  --></td>
</tr>
</tbody>
</table>
<p>Depending on the value of <span class="math inline">\(r\)</span> the variance of ZIP and ZINB may be smaller or bigger than the variance of Poisson distribution. In case of the NB distribution, the variance is always bigger than for the Poisson distribution, although the difference becomes negligible, when the <span class="math inline">\(\theta\)</span> is much bigger than <span class="math inline">\(\lambda^2\)</span>.</p>
<table>
<colgroup>
<col width="59%" />
<col width="40%" />
</colgroup>
<thead>
<tr class="header">
<th>Distribution <br> name</th>
<th>Variance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Poisson</td>
<td><span class="math display">\[\textrm{var}(X) = \lambda \]</span></td>
</tr>
<tr class="even">
<td>ZIP</td>
<td><span class="math display">\[\textrm{var}(X) = \lambda (1 - r)(1 + \lambda r)\]</span></td>
</tr>
<tr class="odd">
<td>NB</td>
<td><span class="math display">\[\textrm{var}(X) = \lambda + \frac{\lambda^2}{\theta} \]</span></td>
</tr>
<tr class="even">
<td>ZINB</td>
<td><span class="math display">\[\textrm{var}(X) = (1 - r) \lambda \left( 1 + r\lambda  + \frac{1}{\theta} \right)\]</span></td>
</tr>
</tbody>
</table>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
